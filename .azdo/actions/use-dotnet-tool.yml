# Installs a specific version of a .NET Core global tool. If an existing version is found but 
# the version doesn't match the requested version, it will uninstall that one and install the 
# right version instead. 
# Requires UsePowerShell from prepare.yml

parameters:
  id: ''
  version: ''
  condition: succeeded()

steps:
- pwsh: |
    if ((dotnet tool list -g | select-string ${{ parameters.id }}) -ne $null) {
      if ((dotnet tool list -g | select-string ${{ parameters.id }} | select-string ${{ parameters.version }}) -eq $null) {
        dotnet tool uninstall -g ${{ parameters.id }}
      } else {
        return
      }
    }
    dotnet tool install -g ${{ parameters.id }} --version ${{ parameters.version }}
  displayName: 'Use ${{ parameters.id }} ${{ parameters.version }}'